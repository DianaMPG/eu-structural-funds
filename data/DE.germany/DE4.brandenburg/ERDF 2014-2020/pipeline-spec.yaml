brandenburg_2014_2020_erdf:
  pipeline:
  - parameters:
      datapackage:
        contributors: [Michael Peters (michael.peters@okfn.de)]
        description: The beneficiary list for Brandenburg 2014-2020 ERDF
        language: de
        resources:
        - cci_code: 2014DE16RFOP004
          currency_code: EUR
          fund_acronym: ERDF
          funding_period: 2014-2020
          path: CSV_ERDF_Brandenburg_2014_2020.csv
          publication_date: '2016-09-30'
          schema:
            fields:
            - {name: "Name des Beg\xFCnstigten"}
            - {name: Bezeichnung des Vorhabens / Zusammenfassung des Vorhabens}
            - {name: Beginns des Vorhabens, translated_to: start date}
            - {name: "Gesamtbetrag der f\xF6rderf\xE4higen Ausgaben des Vorhabens",
              translated_to: total eligible expenditure allocated to the operation}
            - {name: "Unions-Kofinan-zierungssatz  pro Priorit\xE4ts-achse", translated_to: 'Union
                co-financing rate, as per priority axis (in percent)'}
            - {name: Ort des Vorhabens, translated_to: location}
            - {name: Land, translated_to: country}
            - {name: Bezeichnung der Interventionskategorie, translated_to: category
                of intervention}
          title: ERDF in  2014-2020
        scraper_required: false
        sources:
        - {name: ERDF in Brandenburg 2014-2020, web: 'http://www.ERDF.brandenburg.de/cms/detail.php/bb3.c.208471.de'}
        title: Brandenburg 2014-2020 ERDF
    run: read_description
  - parameters: {}
    run: ingest_local_file
  - parameters:
      mappings: []
    run: map_values
  - parameters:
      column-aliases:
        approval_date: []
        beneficiary_address: []
        beneficiary_city: [Ort des Vorhabens]
        beneficiary_country: [Land]
        beneficiary_country_code: []
        beneficiary_county: []
        beneficiary_id: []
        beneficiary_name: ["Name des Beg\xFCnstigten"]
        beneficiary_nuts_code: []
        beneficiary_nuts_region: []
        beneficiary_person: []
        beneficiary_postal_code: []
        beneficiary_url: []
        cci_program_code: []
        cci_program_title: []
        completion_date: []
        eu_cofinancing_amount: []
        eu_cofinancing_amount_eligible: []
        eu_cofinancing_rate: ["Unions-Kofinan-zierungssatz  pro Priorit\xE4ts-achse"]
        european_investment_bank_amount: []
        final_payment_date: []
        first_payment_date: []
        fund_acronym: []
        fund_name: []
        funding_period: []
        funding_period_number: []
        management_authority: []
        member_state_amount: []
        operational_programme: []
        priority_label: [Bezeichnung der Interventionskategorie]
        priority_number: []
        project_description: []
        project_id: []
        project_name: [Bezeichnung des Vorhabens / Zusammenfassung des Vorhabens]
        project_status: []
        source: []
        starting_date: [Beginns des Vorhabens]
        theme_code: []
        theme_name: []
        third_party_amount: []
        total_amount: []
        total_amount_applied: []
        total_amount_eligible: ["Gesamtbetrag der f\xF6rderf\xE4higen Ausgaben des\
            \ Vorhabens"]
    run: concat
  - parameters: {}
    run: reshape_data
  - parameters: {sample_size: 10}
    run: show_sample_in_console
  - parameters: {}
    run: add_geocodes
  - parameters: {}
    run: add_constants
  - parameters: {}
    run: add_categories
  - parameters:
      options:
        eu_cofinancing_amount: {currency: EUR}
        eu_cofinancing_amount_eligible: {currency: EUR}
        european_investment_bank_amount: {currency: EUR}
        member_state_amount: {currency: EUR}
        third_party_amount: {currency: EUR}
        total_amount: {currency: EUR}
        total_amount_applied: {currency: EUR}
        total_amount_eligible: {currency: EUR}
      os-types: {approval_date: 'date:fiscal:activity-approval', beneficiary_address: 'geo-source:address:street-address:description',
        beneficiary_city: 'geo-source:address:city:code', beneficiary_country: 'geo-source:address:country:label',
        beneficiary_country_code: 'geo-source:address:country:code', beneficiary_county: 'geo-source:address:county:code',
        beneficiary_id: 'unknown:string', beneficiary_name: 'recipient:generic:id',
        beneficiary_nuts_code: 'geo-source:address:region:code', beneficiary_nuts_region: 'geo-source:address:region:label',
        beneficiary_person: 'recipient:generic:legal-entity:point-of-contact:description',
        beneficiary_postal_code: 'geo-source:address:zip:code', beneficiary_url: 'recipient:generic:url',
        cci_program_code: 'administrative-classification:generic:level3:code:full',
        cci_program_title: 'administrative-classification:generic:level3:label', completion_date: 'date:fiscal:activity-end',
        eu_cofinancing_amount: value, eu_cofinancing_amount_eligible: value, eu_cofinancing_rate: 'unknown:string',
        european_investment_bank_amount: value, final_payment_date: 'date:fiscal:final-payment',
        first_payment_date: 'date:fiscal:first-payment', fund_acronym: 'fin-source:generic:level2:code:full',
        fund_name: 'fin-source:generic:level2:label', funding_period: 'fin-source:generic:level1:label',
        funding_period_number: 'fin-source:generic:level1:code', management_authority: 'fin-source:generic:level3:code:full',
        member_state_amount: value, operational_programme: 'administrative-classification:generic:level4:code:full',
        priority_label: 'administrative-classification:generic:level2:label', priority_number: 'administrative-classification:generic:level2:code:full',
        project_description: 'recipient:generic:legal-entity:receiving-project:description',
        project_id: 'recipient:generic:legal-entity:receiving-project:code', project_name: 'recipient:generic:legal-entity:receiving-project:label',
        project_status: 'recipient:generic:legal-entity:receiving-project:status',
        source: 'unknown:string', starting_date: 'date:fiscal:activity-start', theme_code: 'administrative-classification:generic:level1:code',
        theme_name: 'administrative-classification:generic:level1:label', third_party_amount: value,
        total_amount: value, total_amount_applied: value, total_amount_eligible: value}
      titles: {approval_date: Approval date of the project, beneficiary_address: Address,
        beneficiary_city: City, beneficiary_country: Country, beneficiary_country_code: Country
          code, beneficiary_county: County, beneficiary_id: Beneficiary ID, beneficiary_name: Beneficiary
          name, beneficiary_nuts_code: NUTS code, beneficiary_nuts_region: NUTS region,
        beneficiary_person: Beneficiary person, beneficiary_postal_code: Postal code,
        beneficiary_url: Beneficiary website, cci_program_code: CCI code, cci_program_title: Operational
          program, completion_date: Completion date of the project, eu_cofinancing_amount: EU
          co-financing, eu_cofinancing_amount_eligible: eligible EU co-financing,
        eu_cofinancing_rate: EU co-financing rate, european_investment_bank_amount: European
          Investment Bank financing, final_payment_date: Date of the final payment,
        first_payment_date: Date of the first payment, fund_acronym: Fund, fund_name: Fund
          name, funding_period: Funding period, funding_period_number: Funding period
          number, management_authority: Management Authority, member_state_amount: Amount
          of national and regional funding, operational_programme: Operational Programme,
        priority_label: Priority, priority_number: Priority number, project_description: Project
          description, project_id: Project ID, project_name: Project name, project_status: Project
          status, source: Source URL, starting_date: Starting date of the project,
        theme_code: Thematic objective code, theme_name: Thematic objective, third_party_amount: Third
          party funding, total_amount: Total cost of the project, total_amount_applied: Total
          amount the project applied for, total_amount_eligible: Total eligible expenditure}
    run: fiscal.model
  - parameters: {}
    run: sniff_and_cast
  - parameters: {out-file: fiscal.datapackage.zip}
    run: dump
  - parameters: {in-file: fiscal.datapackage.zip}
    run: fiscal.upload
  schedule: {crontab: 0 0 1 1 *}
